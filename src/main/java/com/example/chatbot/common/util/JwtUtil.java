package com.example.chatbot.common.util;import io.jsonwebtoken.Claims;import io.jsonwebtoken.Jwts;import io.jsonwebtoken.security.Keys;import lombok.extern.slf4j.Slf4j;import org.springframework.beans.factory.annotation.Value;import org.springframework.stereotype.Component;import javax.crypto.SecretKey;import java.nio.charset.StandardCharsets;import java.util.Date;/** * JWT 유틸리티 클래스 * * @author : 오승훈 * @fileName : JwtUtil * @since : 2026-02-22 */@Slf4j@Componentpublic class JwtUtil {  private final SecretKey secretKey;  private final long expirationTime;  public JwtUtil(      @Value("${jwt.secret}") String secret,      @Value("${jwt.expiration}") long expirationTime) {    this.secretKey = Keys.hmacShaKeyFor(secret.getBytes(StandardCharsets.UTF_8));    this.expirationTime = expirationTime;  }  /**   * JWT 토큰 생성   */  public String generateToken(Long userId, String loginId) {    Date now = new Date();    Date expiryDate = new Date(now.getTime() + expirationTime);    return Jwts.builder()        .subject(String.valueOf(userId))        .claim("loginId", loginId)        .issuedAt(now)        .expiration(expiryDate)        .signWith(secretKey)        .compact();  }  /**   * 토큰에서 사용자 ID 추출   */  public Long getUserIdFromToken(String token) {    Claims claims = parseClaims(token);    return Long.parseLong(claims.getSubject());  }  /**   * 토큰에서 로그인 ID 추출   */  public String getLoginIdFromToken(String token) {    Claims claims = parseClaims(token);    return claims.get("loginId", String.class);  }  /**   * 토큰 유효성 검증   */  public boolean validateToken(String token) {    try {      parseClaims(token);      return true;    } catch (Exception e) {      log.error("JWT 토큰 검증 실패: {}", e.getMessage());      return false;    }  }  /**   * 토큰 파싱   */  private Claims parseClaims(String token) {    return Jwts.parser()        .verifyWith(secretKey)        .build()        .parseSignedClaims(token)        .getPayload();  }}