package com.example.chatbot.common.handler;import com.example.chatbot.common.dto.ErrorResponse;import com.example.chatbot.common.exception.BusinessException;import com.example.chatbot.common.exception.ErrorCode;import com.example.chatbot.common.exception.UnauthorizedException;import lombok.extern.slf4j.Slf4j;import org.springframework.http.HttpStatus;import org.springframework.http.ResponseEntity;import org.springframework.validation.BindException;import org.springframework.web.bind.MethodArgumentNotValidException;import org.springframework.web.bind.MissingServletRequestParameterException;import org.springframework.web.bind.annotation.ExceptionHandler;import org.springframework.web.bind.annotation.RestControllerAdvice;import org.springframework.web.method.annotation.MethodArgumentTypeMismatchException;/** * 전역 예외 처리 * * @author : 오승훈 * @fileName : GlobalExceptionHandler * @since : 2026-02-12 */@Slf4j@RestControllerAdvicepublic class GlobalExceptionHandler {  /**   * BusinessException 처리   */  @ExceptionHandler(BusinessException.class)  protected ResponseEntity<ErrorResponse> handleBusinessException(BusinessException e) {    log.error("BusinessException: {}", e.getMessage());    ErrorCode errorCode = e.getErrorCode();    ErrorResponse response = ErrorResponse.of(errorCode, e.getMessage());    return new ResponseEntity<>(response, errorCode.getStatus());  }  /**   * UnauthorizedException 처리   */  @ExceptionHandler(UnauthorizedException.class)  protected ResponseEntity<ErrorResponse> handleUnauthorizedException(UnauthorizedException e) {    log.error("UnauthorizedException: {}", e.getMessage());    ErrorCode errorCode = e.getErrorCode();    ErrorResponse response = ErrorResponse.of(errorCode, e.getMessage());    return new ResponseEntity<>(response, HttpStatus.UNAUTHORIZED);  }  /**   * @Valid 검증 실패 시   */  @ExceptionHandler(MethodArgumentNotValidException.class)  protected ResponseEntity<ErrorResponse> handleMethodArgumentNotValidException(      MethodArgumentNotValidException e) {    log.error("MethodArgumentNotValidException: {}", e.getMessage());    ErrorResponse response = ErrorResponse.of(ErrorCode.INVALID_INPUT_VALUE, e.getBindingResult());    return new ResponseEntity<>(response, HttpStatus.BAD_REQUEST);  }  /**   * @ModelAttribute 검증 실패 시   */  @ExceptionHandler(BindException.class)  protected ResponseEntity<ErrorResponse> handleBindException(BindException e) {    log.error("BindException: {}", e.getMessage());    ErrorResponse response = ErrorResponse.of(ErrorCode.INVALID_INPUT_VALUE, e.getBindingResult());    return new ResponseEntity<>(response, HttpStatus.BAD_REQUEST);  }  /**   * RequestParam 누락 시   */  @ExceptionHandler(MissingServletRequestParameterException.class)  protected ResponseEntity<ErrorResponse> handleMissingServletRequestParameterException(      MissingServletRequestParameterException e) {    log.error("MissingServletRequestParameterException: {}", e.getMessage());    ErrorResponse response = ErrorResponse.of(ErrorCode.MISSING_REQUEST_PARAMETER);    return new ResponseEntity<>(response, HttpStatus.BAD_REQUEST);  }  /**   * 타입 불일치 시   */  @ExceptionHandler(MethodArgumentTypeMismatchException.class)  protected ResponseEntity<ErrorResponse> handleMethodArgumentTypeMismatchException(      MethodArgumentTypeMismatchException e) {    log.error("MethodArgumentTypeMismatchException: {}", e.getMessage());    ErrorResponse response = ErrorResponse.of(ErrorCode.INVALID_TYPE_VALUE);    return new ResponseEntity<>(response, HttpStatus.BAD_REQUEST);  }  /**   * 기타 모든 예외   */  @ExceptionHandler(Exception.class)  protected ResponseEntity<ErrorResponse> handleException(Exception e) {    log.error("Exception: ", e);    ErrorResponse response = ErrorResponse.of(ErrorCode.INTERNAL_SERVER_ERROR);    return new ResponseEntity<>(response, HttpStatus.INTERNAL_SERVER_ERROR);  }}